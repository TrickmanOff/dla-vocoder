# Vocoder (HiFiGAN)

ДЗ-4 на курсе DLA 23/24.

## Preliminaries

Предварительно необходимо установить используемые зависимости путём вызова команды
```commandline
pip install -r requirements.txt
```

## Обучение модели

Для обучения модели достаточно выбрать конфиг из `configs` или задать свой по аналогии, а
затем запустить команду
```commandline
python3 train.py \
   --config={путь до файла конфига}
```

Для продолжения обучения чекпоинта можно использовать аргумент `-r/--resume`:
```commandline
python3 train.py \
   --config={путь до файла конфига} \
   --resume={путь до сохранённого чекпоинта}
```

> Периодичность и директорию сохранения чекпоинтов моделей можно указать в конфиге обучения.
> Также реализованы импорт/экспорт на Google Диск.

## Inference

Для того, чтобы запустить обученный вокодер на данных, достаточно вызвать скрипт
```commandline
python3 inference.py
```

> Модель обучалась на конфиге `configs/kaggle/basic_orig_loss.json`.

В результате будут загружены веса обученного генератора, который будет затем применён к аудиофайлам
из директории `demo_audios`.
Результат (применения генератора к мел-спектрограмме каждого аудио) будет сохранён в директорию
`inference/result`.

> Если по какой-то причине не работает скачивание по прямой ссылке, то:
> [чекпоинт модели](https://drive.google.com/file/d/1eXQNxni3gdvHJ9WoOvvSutyZ4l9sw5qa/view?usp=drive_link).
> Путь до загруженного чекпоинта необходимо указать в аргументе `-c/--checkpoint` скрипта `inference.py`

Можно также указать следующие аргументы
- `-i/--input`: Путь до директории с аудиофайлами (по умолчанию - `demo_audios`)
- `-o/--output`: Путь до директории, в которую будут сохранены полученные с помощью модели аудио
(по умолчанию - `inference/result`)

## Автор

Егоров Егор:
- tg: [@TrickmanOff](https://t.me/TrickmanOff)
- e-mail: yegyegorov@gmail.com
